  const handleGoogleLogin = async () => {
    setError(null);
    setIsLoadingGoogle(true);
    if (!auth) {
      setError('Authentication service is not available.');
      setIsLoadingGoogle(false);
      return;
    }
    try {
      // ✅ NATIVE AUTH FOR MOBILE
      if (isCapacitorApp()) {
        await GoogleAuth.initialize({
          clientId: '731200978852-8mvn08dar40n0pr1u276hbgmlt9nsqjm.apps.googleusercontent.com',
          scopes: ['profile', 'email'],
          grantOfflineAccess: true,
        });
        const googleUser = await GoogleAuth.signIn();
        const credential = GoogleAuthProvider.credential(googleUser.authentication.idToken);
        const userCredential = await signInWithCredential(auth, credential);
        const user = userCredential.user;
        const idTokenResult = await user.getIdTokenResult();
        const role = idTokenResult.claims.role;
        if (role !== 'rep') {
          await auth.signOut();
          setError('Access denied. This portal is for Representatives only.');
          return;
        }
        router.push('/rep');
      } else {
        // ✅ WEB POPUP FOR BROWSERS
        const provider = new GoogleAuthProvider();
        const userCredential = await signInWithPopup(auth, provider);
        const user = userCredential.user;
        const idTokenResult = await user.getIdTokenResult();
        const role = idTokenResult.claims.role;
        if (role !== 'rep') {
          await auth.signOut();
          setError('Access denied. This portal is for Representatives only.');
          return;
        }
        router.push('/rep');
      }
    } catch (err: any) {
      handleAuthError(err);
    } finally {
      setIsLoadingGoogle(false);
    }
  };
